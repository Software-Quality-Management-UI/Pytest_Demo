default:
  # Minimal pixi image
  image: ghcr.io/prefix-dev/pixi:latest

setup_pixi:
  stage: .pre
  script:
    - pixi add compilers
    - pixi install

# Define some compile job to be used as build stage (calls pdm in pixi)
mycompile:
  stage: build
  # Execute command, prefixed with pixi run
  script:
    - pixi run pdm build

# Define some unit test job to be used as (unit) test stage
myunittest:
  # In Gitlab, stage test   # runs after stage build
  stage: test
  # Execute test command
  script:
    - pixi run pdm sync
    - pixi run pytest
